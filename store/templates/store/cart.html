{% extends 'base.html' %}
{% block content %}
{% for order in orders %}
<h2>Order {{ order.product.name }}</h2>
<img src="{{ order.product.first_image.url }}" alt="image" style="height: 230px;">
<p>{{ order.quantity }} dans le panier</p>
{% endfor %}
<a href="{% url 'delete_cart' %}">supprimer le panier</a>
<script src="https://www.paypal.com/sdk/js?client-id=AW_e5ERfDQ4iOITPYbvP5S5Jffu53Rk35_EMh-zLWoVVeYk2gXqYYVGUm5wgqyvnvvjBVp_KXmo0zGuD&currency=EUR"></script>
<div id="paypal-button-container">
    
</div>
<script>
    paypal.Buttons({
        style : {
            color: 'blue'
        },
        createOrder: function(data, actions) {// la valeur dans les parametre et la fonction sera appeller avec $_SESSION['total']
            return actions.order.create({
                purchase_units:[{
                  amount: {
                      value:0.12
                      
                  }
                }]
            })
        },
        onApprove: function(data, actions) {
            // This function captures the funds from the transaction.
            return actions.order.capture().then(function(details) {
                alert('Transaction completed by ' + details.payer.name.given_name);
                // dans la bd mettre ordered a true

                


             
            })
        }
    }).render('#paypal-button-container');
</script>
{% for order in cart.orders.all %}
<h2>Order {{ order.product.product_name }}</h2>
<img src="{{ order.product.first_image.url }}" alt="image" style="height: 230px;">
<p>{{ order.quantity }} dans le panier</p>
{% endfor %}

<p> prix total : {{ cart.orders.total_price }} </p>
{% endblock %}
